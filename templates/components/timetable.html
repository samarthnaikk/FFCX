<!-- Timetable Display Component -->
<div class="timetable-container mb-4">
    <!-- Timetable Header -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="h4 mb-0">
            <i class="fas fa-calendar-alt me-2"></i>Weekly Timetable
        </h2>
        <div class="timetable-actions">
            <button class="btn btn-outline-primary btn-sm me-2" @click="showPreferencesModal" :disabled="!canOptimize()">
                <i class="fas fa-magic me-1"></i>Optimize
            </button>
            <button class="btn btn-outline-secondary btn-sm" @click="clearTimetable">
                <i class="fas fa-refresh me-1"></i>Reset
            </button>
        </div>
    </div>
    
    <!-- Timetable Grid -->
    <div class="timetable-wrapper">
        <div class="table-responsive">
            <table class="table table-bordered timetable-table">
                <thead>
                    <tr>
                        <th class="time-header">Time</th>
                        <th v-for="day in days" :key="day" class="day-header">{{ day }}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(timeSlot, timeIndex) in timeSlots" :key="timeIndex">
                        <!-- Time column -->
                        <td class="time-cell">
                            <strong>{{ timeSlot.display }}</strong>
                            <div class="time-details">{{ timeSlot.slots }}</div>
                        </td>
                        
                        <!-- Day columns -->
                        <td v-for="day in days" :key="day" 
                            class="slot-cell"
                            :class="getSlotClasses(day, timeIndex)"
                            @dragover="onDragOver"
                            @dragenter="onDragEnter($event, day, timetableData.timetable[day][timeIndex], timeIndex)"
                            @dragleave="onDragLeave"
                            @drop="onDrop($event, day, timetableData.timetable[day][timeIndex], timeIndex)"
                            @click="handleSlotClick(day, timeIndex)">
                            
                            <!-- Course content -->
                            <div v-if="timetableData.timetable[day][timeIndex].course" 
                                 class="course-slot"
                                 draggable="true"
                                 @dragstart="startDrag($event, day, timetableData.timetable[day][timeIndex], timeIndex)"
                                 @dragend="onDragEnd">
                                
                                <!-- Course Header -->
                                <div class="course-header">
                                    <strong class="course-name">{{ timetableData.timetable[day][timeIndex].name }}</strong>
                                    <button class="btn btn-sm btn-danger course-remove-btn" 
                                            @click.stop="removeCourse(day, timeIndex)"
                                            title="Remove course">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <!-- Course Details -->
                                <div class="course-details">
                                    <div class="course-code">{{ timetableData.timetable[day][timeIndex].course_code }}</div>
                                    <div class="course-faculty">
                                        <i class="fas fa-user me-1"></i>{{ timetableData.timetable[day][timeIndex].faculty }}
                                    </div>
                                    <div class="course-venue">
                                        <i class="fas fa-map-marker-alt me-1"></i>{{ timetableData.timetable[day][timeIndex].venue }}
                                    </div>
                                    <div class="course-slot">
                                        <i class="fas fa-clock me-1"></i>{{ timetableData.timetable[day][timeIndex].slot }}
                                    </div>
                                </div>
                                
                                <!-- Course Credits -->
                                <div class="course-credits">
                                    <span class="badge bg-primary">{{ timetableData.timetable[day][timeIndex].credits }} credits</span>
                                </div>
                            </div>
                            
                            <!-- Empty slot -->
                            <div v-else class="empty-slot">
                                <div class="empty-slot-content">
                                    <i class="fas fa-plus text-muted"></i>
                                    <span class="text-muted small">Add Course</span>
                                </div>
                                
                                <!-- Available slots indicator -->
                                <div v-if="timetableData.timetable[day][timeIndex].available_slots" 
                                     class="available-slots">
                                    <small class="text-muted">
                                        Available: {{ timetableData.timetable[day][timeIndex].available_slots }}
                                    </small>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Timetable Legend -->
    <div class="timetable-legend mt-3">
        <div class="row">
            <div class="col-md-6">
                <h6 class="small text-muted mb-2">Legend:</h6>
                <div class="legend-items">
                    <span class="legend-item">
                        <span class="legend-color occupied"></span>
                        <span class="small">Occupied</span>
                    </span>
                    <span class="legend-item">
                        <span class="legend-color free"></span>
                        <span class="small">Free</span>
                    </span>
                    <span class="legend-item">
                        <span class="legend-color conflict"></span>
                        <span class="small">Conflict</span>
                    </span>
                </div>
            </div>
            <div class="col-md-6">
                <h6 class="small text-muted mb-2">Instructions:</h6>
                <ul class="small text-muted mb-0">
                    <li>Drag courses to move them between slots</li>
                    <li>Click '+' to add a new course</li>
                    <li>Use 'Optimize' for automatic scheduling</li>
                </ul>
            </div>
        </div>
    </div>
</div>